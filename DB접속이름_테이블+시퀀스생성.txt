[sql developer 접속]
접속 이름 : db3
사용자 이름 : db3
비밀번호 : qwerty123
--------------------------------------
관리자 계정 접속
<sys.sql>

1. db3계정 생성 (pw : qwerty123)

CREATE USER db3 IDENTIFIED BY qwerty123

2. 권한부여
//권한부여(접속관련)
GRANT CREATE SESSION TO db3

//테이블 생성 권한 부여
GRANT CREATE TABLE TO db3

//리소스 권한 부여 
GRANT RESOURCE TO db3

* 영화db엑셀파일 -> 398번 춘향뎐 데이터 삭제해야함 

-----------------------------------------------------------
<CREATE TABLE>

CREATE TABLE member(
userid VARCHAR2(15) PRIMARY KEY,
userpw VARCHAR2(15) NOT NULL,
tel VARCHAR2(21) NOT NULL,
username VARCHAR2(15) NOT NULL,
birth CHAR(13) NOT NULL,
email VARCHAR2(50) NOT NULL,
gender VARCHAR2(1) CHECK( gender IN ('M', 'F')),
regdate DATE DEFAULT SYSDATE,
photo VARCHAR2(100),
uuid VARCHAR2(100),
authorities VARCHAR2(50))

CREATE TABLE movie(
mno NUMBER PRIMARY KEY,
mname VARCHAR2(100) NOT NULL,
year VARCHAR2(4),
nation VARCHAR2(100),
genre VARCHAR2(50),
summary VARCHAR2(3000),
director VARCHAR2(500),
actor VARCHAR2(500),
avgstar NUMBER,
poster VARCHAR2(100),
uuid VARCHAR2(100))

CREATE TABLE comment(
cno NUMBER PRIMARY KEY,
mno NUMBER NOT NULL CONSTRAINT comment_fk REFERENCES movie(mno),
userid VARCHAR2(15) NOT NULL CONSTRAINT comment_fk REFERENCES member(userid),
star NUMBER NOT NULL,
content VARCHAR2(300) NOT NULL,
regdate DATE DEFAULT SYSDATE)

CREATE TABLE reportcomment(
rcno NUMBER PRIMARY KEY,
cno NUMBER  NOT NULL CONSTRAINT report_comment_fk REFERENCES comment(cno),
userid VARCHAR2(15)  NOT NULL CONSTRAINT report_comment_fk REFERENCES member(userid))

CREATE TABLE recommend(
reno NUMBER PRIMARY KEY,
userid VARCHAR2(15) CONSTRAINT recommend_fk REFERENCES member(userid),
title VARCHAR2(60) NOT NULL,
content VARCHAR2(600) NOT NULL,
regdate DATE DEFAULT SYSDATE)

CREATE TABLE recommendreply(
rereno NUMBER PRIMARY KEY,
reno NUMBER CONSTRAINT recommend_reply_fk REFERENCES recommend(reno),
userid VARCHAR2(15) CONSTRAINT recommend_reply_fk REFERENCES member(userid),
content VARCHAR2(200) NOT NULL,
regdate DATE DEFAULT SYSDATE)

CREATE TABLE qna(
qno NUMBER PRIMARY KEY,
userid VARCHAR2(15) CONSTRAINT qna_fk REFERENCES member(userid),
title VARCHAR2(60) NOT NULL,
content VARCHAR2(600) NOT NULL,
regdate DATE DEFAULT SYSDATE)

CREATE TABLE qnareply(
qreno NUMBER PRIMARY KEY,
qno NUMBER CONSTRAINT qna_reply_fk REFERENCES qna(qno),
userid VARCHAR2(15) CONSTRAINT qna_reply_fk REFERENCES member(userid),
content VARCHAR2(200) NOT NULL,
regdate DATE DEFAULT SYSDATE)

CREATE TABLE movieattach(
mano NUMBER PRIMARY KEY,
mno NUMBER CONSTRAINT movie_attach_fk REFERENCES movie(mno),
uuid1 VARCHAR2(100),
uuid2 VARCHAR2(100),
uuid3 VARCHAR2(100),
filename1 VARCHAR2(100),
filename2 VARCHAR2(100),
filename3 VARCHAR2(100))

CREATE TABLE wish(
wno NUMBER PRIMARY KEY,
mno NUMBER CONSTRAINT wish_fk REFERENCES movie(mno),
userid VARCHAR2(15) CONSTRAINT wish_fk REFERENCES member(userid))

CREATE TABLE blacklist(
blackno NUMBER PRIMARY KEY,
userid VARCHAR2(15) NOT NULL,
username VARCHAR2(15) NOT NULL,
birth CHAR(13) NOT NULL)

CREATE TABLE follow(
userid VARCHAR2(15) CONSTRAINT follow_fk REFERENCES member(userid),
follower VARCHAR2(15) CONSTRAINT follow_fk REFERENCES member(userid))

CREATE TABLE event(
eno NUMBER PRIMARY KEY,
userid VARCHAR2(15) NOT NULL CONSTRAINT event_fk REFERENCES member(userid),
title VARCHAR2(100) NOT NULL,
stardate DATE,
enddate DATE,
photo VARCHAR2(100) NOT NULL)

CREATE TABLE eventattend(
eattendno NUMBER PRIMARY KEY,
eno NUMBER CONSTRAINT event_attend_fk REFERENCES event(eno),
userid VARCHAR2(15) CONSTRAINT event_attend_fk REFERENCES member(userid),
regdate DATE DEFAULT SYSDATE)

CREATE TABLE eventwin(
ewinno NUMBER PRIMARY KEY,
eno NUMBER CONSTRAINT event_win_fk REFERENCES event(eno),
userid VARCHAR2(15) CONSTRAINT event_win_fk REFERENCES member(userid),
regdate DATE DEFAULT SYSDATE)

CREATE TABLE bestscene(
bsno NUMBER PRIMARY KEY,
mno NUMBER CONSTRAINT best_scene_fk REFERENCES movie(mno),
userid VARCHAR2(15) CONSTRAINT best_scene_fk REFERENCES member(userid),
content VARCHAR2(600) NOT NULL,
like NUMBER,
photo VARCHAR2(100),
uuid VARCHAR2(100),
regdate DATE DEFAULT SYSDATE)

CREATE TABLE reportbestscene(
rebsno  NUMBER PRIMARY KEY,
bsno NUMBER CONSTRAINT report_bestscene_fk REFERENCES bestscene(bsno),
userid VARCHAR2(15) CONSTRAINT report_bestscene_fk REFERENCES member(userid))
-----------------------------------------------------------------------------------------------------

<CREATE SEQUENCE>

CREATE SEQUENCE movie_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE OR REPLACE TRIGGER TG_COL_INSERT
BEFORE INSERT
ON movie FOR EACH ROW
BEGIN
SELECT movie_seq.NEXTVAL INTO :new.mno FROM dual; 
END;


CREATE SEQUENCE comment_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE report_comment_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE recommend_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE recommend_reply_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE qna_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE qna_reply_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE blacklist_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE event_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE event_attend_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE event_win_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE best_scene_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE report_bestscene_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE movie_attach_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle

CREATE SEQUENCE wish_seq
start with 1
increment by 1
maxvalue 999999999999
nocache
nocycle